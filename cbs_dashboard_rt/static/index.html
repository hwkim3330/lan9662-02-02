<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CBS Real-time Dashboard</title>
  <style>
    :root {
      --bg: #0b0d12;
      --bg-2: #0f1219;
      --card: #141925;
      --card-2: #111620;
      --text: #e8edf7;
      --muted: #9aa4b2;
      --accent: #6aa9ff;
      --accent2: #6ee7b7;
      --warn: #fbbf24;
      --bad: #fb7185;
      --grid: #242b3a;
      --shadow: 0 12px 36px rgba(3, 7, 18, 0.5);
      --outline: rgba(255,255,255,0.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Space Grotesk", "SF Pro Display", "Segoe UI", sans-serif;
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(106,169,255,0.12), transparent 60%),
        radial-gradient(900px 600px at 90% 0%, rgba(110,231,183,0.10), transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg-2) 100%);
      color: var(--text);
    }
    header {
      padding: 20px 28px;
      border-bottom: 1px solid var(--outline);
      display:flex;
      gap:18px;
      align-items:center;
      flex-wrap:wrap;
      background: rgba(13, 17, 26, 0.85);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header h1 { font-size: 18px; margin:0; letter-spacing: 0.3px; }
    header .sub { color: var(--muted); font-size: 12px; }
    .container { padding: 20px 28px 40px; display: grid; gap: 16px; }
    .card {
      background: var(--card);
      border: 1px solid var(--outline);
      border-radius: 18px;
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .row-3 { display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
    .label { color: var(--muted); font-size: 11px; margin-bottom: 6px; text-transform: uppercase; letter-spacing: .08em; }
    .value { font-size: 22px; font-weight: 600; }
    .grid-8 { display:grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    .chart {
      background: var(--card-2);
      border:1px solid var(--outline);
      border-radius:14px;
      padding:12px;
    }
    canvas { width: 100%; height: 190px; display:block; }
    .controls { display:grid; grid-template-columns: repeat(6, 1fr); gap: 12px; }
    .controls .field { display:flex; flex-direction:column; gap:6px; }
    input, select {
      background:#0e141f;
      color:var(--text);
      border:1px solid var(--outline);
      border-radius:10px;
      padding:10px 12px;
    }
    button {
      background:#1a2130;
      color:var(--text);
      border:0;
      border-radius:12px;
      padding:10px 14px;
      cursor:pointer;
      font-weight:600;
    }
    button.primary { background:#2b6df6; color:#fff; }
    button.stop { background:#ef4444; color:#fff; }
    .badge { padding:5px 10px; border-radius:999px; font-size:11px; font-weight:600; border:1px solid var(--outline); }
    .ok { background:#0f2a1f; color:#6ee7b7; }
    .bad { background:#2a1217; color:#fb7185; }
    .warn { background:#2a1f0f; color:#fbbf24; }
    .tc-table { width:100%; border-collapse: collapse; font-size:12px; }
    .tc-table th, .tc-table td { border-bottom:1px solid var(--outline); padding:8px 6px; text-align:center; }
    .tc-table thead th { position: sticky; top: 0; background: #0f141f; z-index: 1; }
    .sample-table { width:100%; border-collapse: collapse; font-size:12px; }
    .sample-table th, .sample-table td { border-bottom:1px solid var(--outline); padding:7px 6px; text-align:center; }
    .sample-table thead th { position: sticky; top: 0; background: #0f141f; z-index: 1; }
    .pill { padding:6px 10px; background:#101826; border:1px solid var(--outline); border-radius:999px; font-size:12px; color: var(--muted); }
    @media (max-width: 1400px) {
      .controls { grid-template-columns: repeat(3, 1fr); }
      .grid-8 { grid-template-columns: repeat(2, 1fr); }
      canvas { height: 200px; }
    }
    @media (max-width: 900px) {
      .controls { grid-template-columns: repeat(2, 1fr); }
      .grid-8 { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>CBS Real-time Dashboard</h1>
      <div class="sub">Start → CBS 설정 적용 + 트래픽 전송 + 실시간 캡처 + idle-slope 예측/검증</div>
    </div>
  </header>

  <div class="container">
    <div class="card">
      <div class="label">Controls</div>
      <div class="controls">
        <div class="field"><label class="label">Ingress IF</label><input id="ingress" value="enx00e04c6812d1"></div>
        <div class="field"><label class="label">Egress IF</label><input id="egress" value="enxc84d44263ba6"></div>
        <div class="field"><label class="label">Dst MAC</label><input id="dstmac" value="c8:4d:44:26:3b:a6"></div>
        <div class="field"><label class="label">VLAN</label><input id="vlan" value="100"></div>
        <div class="field"><label class="label">Duration (s)</label><input id="duration" value="60"></div>
        <div class="field"><label class="label">Pkt Size</label><input id="pktsize" value="512"></div>
        <div class="field"><label class="label">Egress Port</label><input id="egressPort" value="1"></div>
        <div class="field"><label class="label">Ingress Port</label><input id="ingressPort" value="2"></div>
        <div class="field"><label class="label">Rate/TC (Mbps)</label><input id="rate" value="10"></div>
        <div class="field"><label class="label">Tolerance (0.1=10%)</label><input id="tol" value="0.1"></div>
        <div class="field"><label class="label">Idle-Slope Scale</label><input id="idleScale" value="1.0"></div>
        <div class="field"><label class="label">Smooth Window (sec)</label><input id="smooth" value="10"></div>
        <div class="field"><label class="label">RX Batch</label><input id="rxBatch" value="512"></div>
        <div class="field"><label class="label">TX Batch</label><input id="txBatch" value="1"></div>
        <div class="field"><label class="label">RX CPU</label><input id="rxCpu" value="2"></div>
        <div class="field"><label class="label">TX CPU</label><input id="txCpu" value="3"></div>
        <div class="field"><label class="label">Dst IP</label><input id="dstip" value="10.0.100.2"></div>
      </div>
      <div style="margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <button id="applyBtn">Apply CBS</button>
        <button class="primary" id="startBtn">Start</button>
        <button class="stop" id="stopBtn">Stop</button>
        <div id="status" class="badge warn">IDLE</div>
      </div>
    </div>

    <div class="row">
      <div class="card"><div class="label">Total Mbps</div><div class="value" id="totalMbps">-</div></div>
      <div class="card"><div class="label">Total Packets / Drops</div><div class="value" id="totalPkts">-</div></div>
    </div>

    <div class="card">
      <div class="label">Idle-Slope (kbps) - target shaping per TC</div>
      <div class="grid-8" id="idleSlopeInputs"></div>
    </div>

    <div class="card">
      <div class="label">Total Throughput (RX vs TX)</div>
      <div class="chart">
        <canvas id="totalChart" width="1280" height="260"></canvas>
      </div>
    </div>

    <div class="card">
      <div class="label">Per-TC Validation (TX vs RX vs Pred)</div>
      <table class="tc-table" id="tcTable">
        <thead>
          <tr><th>TC</th><th>TX (Mbps)</th><th>RX (Mbps)</th><th>Pred (Mbps)</th><th>Expected</th><th>Status</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <div class="label">Per-TC Throughput Charts</div>
      <div class="grid-8" id="charts"></div>
    </div>

    <div class="card">
      <div class="label">TX/RX Samples (interval summary)</div>
      <table class="sample-table" id="sampleTable">
        <thead>
          <tr>
            <th>t(s)</th><th>RX Mbps</th><th>TX Mbps</th><th>RX PPS</th><th>Total Pkts</th><th>Drops</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

<script src="app.js"></script>
</body>
</html>
